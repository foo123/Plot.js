/**
*   Plot.js, version 1.0.0
*   Simple shape sketching and chart / functional graph plotting library which can render to Canvas, SVG and plain HTML
*   https://github.com/foo123/Plot.js
**/
!function(e,t){"use strict";t in e||(e[t]=function(){"use strict";var M=Math,t="prototype",e=1e-6,y=/\s+/,s=Object[t].hasOwnProperty,r=Object[t].toString;if(!M.hypot){M.hypot=function(e,t){var r=0,n=0,i,o;for(i=0;i<arguments.length;i+=1){o=M.abs(Number(arguments[i]));if(o>r){n*=r/o*(r/o);r=o}n+=o===0&&r===0?0:o/r*(o/r)}return r===1/0?1/0:r*M.sqrt(n)}}function n(e){return function(){throw new Error(e||"Error")}}function i(e){return r.call(e).slice(8,-1)}function Y(e){return"Array"===i(e)}function d(e){return"Object"===i(e)}function h(e){return"function"===typeof e}function l(e){return!isNaN(e)&&isFinite(e)}function B(e){var t={},r;for(r in e){if(!s.call(e,r))continue;if(d(e[r]))t[r]=B(e[r]);else t[r]=e[r]}return t}function F(){var e=arguments,t=e.length,r=t?true===e[0]:false,n=r?1:0,i=(t>n?e[n]:{})||{},o,a,l;for(a=n+1;a<t;a++){o=e[a];for(l in o){if(!s.call(o,l))continue;if(r&&d(i[l])&&d(o[l]))i[l]=F(true,i[l],o[l]);else i[l]=o[l]}}return i}function o(r,n){var i=null;return function(){var e=this,t=arguments;clearTimeout(i),i=setTimeout(function(){r.apply(e,t)},n)}}function v(e){if(e){if(255>e[2])return[e[0],e[1],e[2]+1];else if(255>e[1])return[e[0],e[1]+1,0];else if(255>e[0])return[e[0]+1,0,0]}return[0,0,0]}function a(e){return[(e=parseInt("#"===e.charAt(0)?e.slice(1):e,16))>>16&255,e>>8&255,255&e]}function L(e){var t=[Number(e[0]).toString(16),Number(e[1]).toString(16),Number(e[2]).toString(16)];if(1===t[0].length)t[0]="0"+t[0];if(1===t[1].length)t[1]="0"+t[1];if(1===t[2].length)t[2]="0"+t[2];return t[0]+t[1]+t[2]}function c(e){var t,r,n,i=M.round(e[0]),o=M.round(e[1]*255/100),a=M.round(e[2]*255/100);if(o===0){t=r=n=a}else{var l=a,s=(255-o)*a/255,d=(l-s)*(i%60)/60;if(i==360)i=0;if(i<60){t=l;n=s;r=s+d}else if(i<120){r=l;n=s;t=l-d}else if(i<180){r=l;t=s;n=s+d}else if(i<240){n=l;t=s;r=l-d}else if(i<300){n=l;r=s;t=s+d}else if(i<360){t=l;r=s;n=l-d}else{t=0;r=0;n=0}}return[M.round(t),M.round(r),M.round(n)]}function u(e){var t=0,r=0,n=0,i=e[0],o=e[1],a=e[2],l=M.min(i,o,a),s=M.max(i,o,a),d=s-l;if(0!=(n=s));if(0!=(r=0!=s?255*d/s:0))t=i===s?(o-a)/d:o===s?2+(a-i)/d:4+(i-o)/d;else t=-1;if((t*=60)<0)t+=360;return r=100*r/255,n=100*n/255,[M.round(t),M.round(r),M.round(n)]}function R(e,t){t=String(t||"hex").toLowerCase();var r=new Array(e),n=M.min(e,60),i,o,a;for(i=0,o=0;i<e;i++){a=c([o*360/n,100,100]);r[i]="rgb"===t?"rgb("+a.join(",")+")":"#"+L(a);o+=2;if(o>=n)o=o&1?0:1}return r}function p(e){var t,r=new Array(e);for(t=0;t<e;t++)r[t]="Entry: "+String(t+1);return r}function O(e){return e}function x(e){return M.log10(e)}function g(e){return e.x}function f(e){return e.y}function b(t){return function(e){if("number"===typeof e)return t-e;e.y=t-e.y;return e}}function W(e,t,r,n){r=r||0;return true===n?e+r*(t-e):0>r?e:1<r?t:e+r*(t-e)}function w(t,r){if("number"==typeof r)r={x:r,y:r};return{x:function(e){return t.x+r.x*M.cos(e)},y:function(e){return t.y+r.y*M.sin(e)}}}function m(o){return 4<=o.length?function(e){var t=e,r=1-e,n=t*t,i=r*r;return r*i*o[0]+3*i*t*o[1]+3*r*n*o[2]+n*t*o[3]}:3===o.length?function(e){var t=e,r=1-e,n=t*t,i=r*r;return i*o[0]+2*r*t*o[1]+n*o[2]}:2===o.length?function(e){return(1-e)*o[0]+e*o[1]}:function(e){return o[0]||0}}function S(e){var t,r,n,i,o,a,l,s,d=e.length-1;r=new Array(d);n=new Array(d);i=new Array(d);o=new Array(d);a=new Array(d);l=new Array(d);i[0]=0;o[0]=2;a[0]=1;l[0]=e[0]+2*e[1];for(t=1;t<d-1;t++){i[t]=1;o[t]=4;a[t]=1;l[t]=4*e[t]+2*e[t+1]}i[d-1]=2;o[d-1]=7;a[d-1]=0;l[d-1]=8*e[d-1]+e[d];for(t=1;t<d;t++){s=i[t]/o[t-1];o[t]=o[t]-s*a[t-1];l[t]=l[t]-s*l[t-1]}r[d-1]=l[d-1]/o[d-1];for(t=d-2;t>=0;--t)r[t]=(l[t]-a[t]*r[t+1])/o[t];for(t=0;t<d-1;t++)n[t]=2*e[t+1]-r[t+1];n[d-1]=(e[d]+r[d-1])/2;return[r,n]}function C(e){var t,r,n;if(2>=e.length){n=[e]}else{n=[];r=S(e);for(t=0;t<e.length-1;t++)n.push([e[t],r[0][t],r[1][t],e[t+1]])}return n}function k(e){return M.hypot(e[0],e[1])}function P(e,t){return(e[0]*t[0]+e[1]*t[1])/(k(e)*k(t))}function I(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*M.acos(P(e,t))}function z(e,t,r,n,i,o){r=r*M.PI/180;var a=M.sin(r),l=M.cos(r),s=(l*(e.x-o.x)+a*(e.y-o.y))/2,d=(-a*(e.x-o.x)+l*(e.y-o.y))/2,h=t.x,c=t.y,u,y,p,x,g,f,b,w,m,v,L,S,C,k,z,T,A,E,D;w=M.pow(s,2);m=M.pow(d,2);f=M.pow(h,2);b=M.pow(c,2);u=w/f+m/b;if(u>1){y=M.sqrt(u);h*=y;c*=y}f=M.pow(h,2);b=M.pow(c,2);p=(n==i?-1:1)*M.sqrt((f*b-f*m-b*w)/(f*m+b*w));if(isNaN(p))p=0;x=p*h*d/c;g=p*-c*s/h;v=(e.x+o.x)/2+l*x-a*g;L=(e.y+o.y)/2+a*x+l*g;S=I([1,0],[(s-x)/h,(d-g)/c]);C=[(s-x)/h,(d-g)/c];k=[(-s-x)/h,(-d-g)/c];z=I(C,k);D=P(C,k);if(D<=-1)z=M.PI;if(D>=1)z=0;T=h>c?h:c;A=h>c?1:h/c;E=h>c?c/h:1;return[v,L,r,A,E,T,S,z,i]}function T(e,t,r,n,i,o,a){var l=this,s=(t+r)/2,d=o||new H(e.x(t),e.y(t)),h=a||new H(e.x(r),e.y(r)),c=new H(e.x(s),e.y(s));if(0>=i||c.dist(d,h)<=n){return d.eq(c)||h.eq(c)?[d,h]:[d,c,h]}else{return T(e,t,s,n,i-1,d,c).concat(T(e,s,r,n,i-1,c,h).slice(1))}}function A(e,t){t=t||window.event;var r,n,i,o,a,l=e.getBoundingClientRect();if(t.changedTouches&&t.changedTouches.length)r=t.changedTouches[0].clientX,n=t.changedTouches[0].clientY,i=t.changedTouches[0].pageX,o=t.changedTouches[0].pageY;else r=t.clientX,n=t.clientY,i=t.pageX,o=t.pageY;return a=r-l.left,{top:n-l.top,left:a,clientX:r,clientY:n,pageX:i,pageY:o}}function H(e,t){var r=this;if(!(r instanceof H))return new H(e,t);if(e instanceof H){r.x=e.x;r.y=e.y}else if(null!=e&&null!=t){r.x=e;r.y=t}else{r.x=0;r.y=0}}function q(e){var t=this;if(!(t instanceof q))return new q(e);if(e instanceof q){t.v=e.v.slice()}else if(e&&9===e.length){t.v=e}else{t.v=[1,0,0,0,1,0,0,0,1]}}function E(e,t){}function D(e,t){var r=this;if(!(r instanceof D))return new D(e,t);r.renderer=e instanceof D.Renderer?e:new D.Renderer.Html(e||document.body);r.tooltip=document.createElement("div");r.tooltip.className="--plot-tooltip --plot-hide-tooltip";r.tooltip.style.position="absolute";document.body.appendChild(r.tooltip);r.opts=F(true,r.defaultOpts(),t||{})}return H[t]={constructor:H,x:0,y:0,dispose:function(){return this.x=null,this.y=null,this},eq:function(e,t){return 2<=arguments.length?M.hypot(this.x-e.x,this.y-e.y)<=(t||0):this.x===e.x&&this.y===e.y},dist:function(e,t){var r=t.x-e.x,n=t.y-e.y;return M.abs(n*this.x-r*this.y+t.x*e.y-t.y*e.x)/M.hypot(n,r)},apply:function(e,t){return null==t&&(t=e),e instanceof q?e.transform(this):h(e)&&h(t)?new H(e(this.x),t(this.y)):this}},H.isFinite=function(e){return l(e.x)&&l(e.y)},q[t]={constructor:q,v:null,dispose:function(){return this.v=null,this},eq:function(e){var t,r=this.v,n=e.v;for(t=0;t<9;t++)if(r[t]!==n[t])return!1;return!0},mul:function(e){var t,r,n,i=this.v;return e instanceof H||s.call(e,"x")&&s.call(e,"y")?(r=e.x,n=e.y,new H(i[0]*r+i[1]*n+i[2],i[3]*r+i[4]*n+i[5])):e instanceof q?(t=e.v,new q([i[0]*t[0]+i[1]*t[3]+i[2]*t[6],i[0]*t[1]+i[1]*t[4]+i[2]*t[7],i[0]*t[2]+i[1]*t[5]+i[2]*t[8],i[3]*t[0]+i[4]*t[3]+i[5]*t[6],i[3]*t[1]+i[4]*t[4]+i[5]*t[7],i[3]*t[2]+i[4]*t[5]+i[5]*t[8],i[6]*t[0]+i[7]*t[3]+i[8]*t[6],i[6]*t[1]+i[7]*t[4]+i[8]*t[7],i[6]*t[2]+i[7]*t[5]+i[8]*t[8]])):this},skew:function(e,t){return new q([1,e||0,0,t||0,1,0,0,0,1]).mul(this)},scale:function(e,t){return 1===arguments.length&&(t=e),new q([e,0,0,0,t,0,0,0,1]).mul(this)},rotate:function(e){e=e||0;var t=M.sin(e),r=M.cos(e);return new q([r,-t,0,t,r,0,0,0,1]).mul(this)},translate:function(e,t){return new q([1,0,e||0,0,1,t||0,0,0,1]).mul(this)},transform:function(e){return this.mul(e)}},E[t]={constructor:E,container:null,opts:null,drawLayer:null,nextColor:null,hitDict:null,hitTarget:null,handler:null,dispose:function(){var e=this;return e.container&&e.drawLayer&&(e.handler&&(e.drawLayer.removeEventListener("touchstart",e.handler,!1),e.drawLayer.removeEventListener("mouseenter",e.handler,!1),e.drawLayer.removeEventListener("click",e.handler,!1)),e.container.removeChild(e.drawLayer)),e.container=null,e.opts=null,e.drawLayer=null,e.nextColor=null,e.hitDict=null,e.hitTarget=null,e.handler=null,e},defaultOpts:function(){return{background:{color:"#ffffff"},text:{size:12,color:"#000000"},point:{size:4,color:"#000000"},line:{size:1,color:"#000000",style:"solid"},shape:{border:{size:1,color:"#000000",style:"solid"},fill:"none"},label:{text:{size:12,color:"#000000"},border:{size:1,color:"#000000",style:"solid"},fill:"none",padding:{top:0,right:0,bottom:0,left:0}}}},width:function(){return this.drawLayer?this.drawLayer.clientWidth:0},height:function(){return this.drawLayer?this.drawLayer.clientHeight:0},resize:function(){return this},init:n("Method not implemented!"),objAt:n("Method not implemented!"),clear:n("Method not implemented!"),background:n("Method not implemented!"),drawPoint:n("Method not implemented!"),drawLine:n("Method not implemented!"),drawRect:n("Method not implemented!"),drawEllipse:n("Method not implemented!"),drawArc:n("Method not implemented!"),drawBezier:n("Method not implemented!"),drawText:n("Method not implemented!")},E.handler=function(e){var t,r,n=this,i=n.drawLayer===e.target;function o(e,t,r,n){var i;e&&t&&t.extra&&t.extra.listener&&h(t.extra.listener[e])&&(i={localX:r.left,localY:r.top,clientX:r.clientX,clientY:r.clientY,pageX:r.pageX,pageY:r.pageY},t.extra.listener[e](e,t,i,n))}if(i&&("touchstart"===e.type?(n.drawLayer.addEventListener("touchmove",n.handler,!1),n.drawLayer.addEventListener("touchend",n.handler,!1),n.drawLayer.addEventListener("touchcancel",n.handler,!1)):"touchend"===e.type||"touchcancel"===e.type?(n.drawLayer.removeEventListener("touchmove",n.handler,!1),n.drawLayer.removeEventListener("touchend",n.handler,!1),n.drawLayer.removeEventListener("touchcancel",n.handler,!1),n.hitTarget&&(o("leave",n.hitTarget.obj,n.hitTarget.pos,e),n.hitTarget=null)):"mouseenter"===e.type?(n.drawLayer.addEventListener("mouseleave",n.handler,!1),n.drawLayer.addEventListener("mousemove",n.handler,!1)):"mouseleave"===e.type&&(n.drawLayer.removeEventListener("mouseleave",n.handler,!1),n.drawLayer.removeEventListener("mousemove",n.handler,!1),n.hitTarget&&(o("leave",n.hitTarget.obj,n.hitTarget.pos,e),n.hitTarget=null))),"touchmove"===e.type||"mousemove"===e.type||"click"===e.type){if(t=function(e,t){t=t||window.event;var r,n,i,o,a,l=e.getBoundingClientRect();o=t.changedTouches&&t.changedTouches.length?(r=t.changedTouches[0].clientX,n=t.changedTouches[0].clientY,i=t.changedTouches[0].pageX,t.changedTouches[0].pageY):(r=t.clientX,n=t.clientY,i=t.pageX,t.pageY);return a=r-l.left,{top:n-l.top,left:a,clientX:r,clientY:n,pageX:i,pageY:o}}(n.drawLayer,e),r=n.objAt(e,t),i&&!r)return;r?(n.hitTarget&&(n.hitTarget.obj!==r?(o("leave",n.hitTarget.obj,n.hitTarget.pos=t,e),n.hitTarget=null):"click"!==e.type&&o("move",n.hitTarget.obj,n.hitTarget.pos=t,e)),n.hitTarget||(n.hitTarget={obj:r,pos:t},o("enter",n.hitTarget.obj,n.hitTarget.pos=t,e)),"click"===e.type&&o("click",n.hitTarget.obj,n.hitTarget.pos=t,e)):n.hitTarget&&(o("leave",n.hitTarget.obj,n.hitTarget.pos=t,e),n.hitTarget=null)}},(E.Html=function e(t,r){if(!(this instanceof e))return new e(t,r);this.container=t,this.opts=F(!0,this.defaultOpts(),r||{})})[t]=F(new E,{constructor:E.Html,init:function(){var e=this;return e.drawLayer||(e.nextColor=[0,0,0],e.hitDict={},e.hitTarget=null,e.drawLayer=document.createElement("div"),e.drawLayer.className="--plot-html",e.drawLayer.style.position="absolute",e.drawLayer.style.left="0px",e.drawLayer.style.top="0px",e.drawLayer.style.width="100%",e.drawLayer.style.height="100%",e.drawLayer.style.display="block",e.drawLayer.style.overflow="hidden",e.drawLayer.style.margin="0px",e.drawLayer.style.padding="0px",e.drawLayer.style.border="none",e.drawLayer.style.backgroundColor=e.opts.background.color,e.container.appendChild(e.drawLayer),e.handler=E.handler.bind(e),e.drawLayer.addEventListener("touchstart",e.handler,!1),e.drawLayer.addEventListener("mouseenter",e.handler,!1),e.drawLayer.addEventListener("click",e.handler,!1)),e},objAt:function(e,t){var r=e.target?e.target.hitId:null;return r&&s.call(this.hitDict,r)?this.hitDict[r]:null},clear:function(){var e=this;return e.drawLayer.innerHTML="",e.nextColor=[0,0,0],e.hitDict={},e.hitTarget=null,e},background:function(e){return this.opts.background.color=e,this.drawLayer.style.backgroundColor=this.opts.background.color,this},drawPoint:function(e,t,r,n){var i=this,o=document.createElement("div");return t=null!=t?t:i.opts.point.size,r=String(r||i.opts.point.color).toLowerCase(),o.className="--plot-point",o.style.position="absolute",o.style.display="inline-block",o.style.overflow="hidden",o.style.boxSizing="border-box",o.style.margin="0px",o.style.padding="0px",o.style.width=String(2*t)+"px",o.style.height=String(2*t)+"px",o.style.border="1px solid "+r,o.style.borderRadius="50%",o.style.backgroundColor=r,o.style.left=String(e.x)+"px",o.style.top=String(e.y)+"px",o.style.transformOrigin="left top",o.style.transform="translate(-50%,-50%)",o.hitId=L(i.nextColor=v(i.nextColor)),i.hitDict[o.hitId]={type:"point",pos:e,extra:n||null},i.drawLayer.appendChild(o),i},drawLine:function(e,t,r,n,i,o,a){var l=this,s=document.createElement("div"),d=t.y-e.y,h=t.x-e.x,c=M.hypot(d,h);return r=null!=r?r:l.opts.line.size,n=String(n||l.opts.line.color).toLowerCase(),"dashed"!==(i=String(i||l.opts.line.style).toLowerCase())&&"dotted"!==i&&(i="solid"),s.className="--plot-line",s.style.position="absolute",s.style.display="inline-block",s.style.boxSizing="border-box",s.style.margin="0px",s.style.padding="0px",s.style.border="none",s.style.background="none",s.style.width=String(c)+"px",s.style.height="0px",s.style.borderBottom=String(r)+"px "+i+" "+n,s.style.left=String(e.x)+"px",s.style.top=String(e.y)+"px",s.style.transformOrigin="left top",s.style.transform="rotate("+String(M.atan2(d,h))+"rad)",a?s.hitId=a:(s.hitId=L(l.nextColor=v(l.nextColor)),l.hitDict[s.hitId]={type:"line",pos:[e,t],extra:o||null}),l.drawLayer.appendChild(s),l},drawRect:function(e,t,r,n,i,o,a,l){var s=this,d=document.createElement("div");return n=null!=n?n:s.opts.shape.border.size,i=String(i||s.opts.shape.border.color).toLowerCase(),"dashed"!==(o=String(o||s.opts.shape.border.style).toLowerCase())&&"dotted"!==o&&(o="solid"),a=String(null!=a?a:s.opts.shape.fill).toLowerCase(),d.className="--plot-rectangle",d.style.position="absolute",d.style.display="inline-block",d.style.overflow="hidden",d.style.boxSizing="border-box",d.style.margin="0px",d.style.padding="0px",d.style.background=a||"none",d.style.width=String(t.x)+"px",d.style.height=String(t.y)+"px",d.style.border=0<n?String(n)+"px "+o+" "+i:"none",d.style.left=String(e.x-t.x/2)+"px",d.style.top=String(e.y-t.y/2)+"px",d.style.transformOrigin="center center",d.style.transform="rotate("+String((r||0)*M.PI/180)+"rad)",d.hitId=L(s.nextColor=v(s.nextColor)),s.hitDict[d.hitId]={type:"rect",center:e,side:t,rotation:r,extra:l||null},s.drawLayer.appendChild(d),s},drawEllipse:function(e,t,r,n,i,o,a,l){var s=this,d=document.createElement("div");return n=null!=n?n:s.opts.shape.border.size,i=String(i||s.opts.shape.border.color).toLowerCase(),"dashed"!==(o=String(o||s.opts.shape.border.style).toLowerCase())&&"dotted"!==o&&(o="solid"),a=String(null!=a?a:s.opts.shape.fill).toLowerCase(),d.className="--plot-ellipse",d.style.position="absolute",d.style.display="inline-block",d.style.overflow="hidden",d.style.boxSizing="border-box",d.style.margin="0px",d.style.padding="0px",d.style.background=a||"none",d.style.width=String(2*t.x)+"px",d.style.height=String(2*t.y)+"px",d.style.border=0<n?String(n)+"px "+o+" "+i:"none",d.style.borderRadius="50%",d.style.left=String(e.x-t.x)+"px",d.style.top=String(e.y-t.y)+"px",d.style.transformOrigin="center center",d.style.transform="rotate("+String((r||0)*M.PI/180)+"rad)",d.hitId=L(s.nextColor=v(s.nextColor)),s.hitDict[d.hitId]={type:"ellipse",center:e,radius:t,rotation:r,extrar:l||null},s.drawLayer.appendChild(d),s},drawArc:function(e,t,r,n,i,o,a,l,s,d){var h,c,u,y,p,x,g,f,b,w=this,m=w.height();for(g=(y=z(e,t,r||0,n?1:0,i?1:0,o))[6],f=y[6]+y[7],b=1-y[8],x=q().scale(y[3],(b?1:-1)*y[4]).rotate(-y[2]).translate(y[0],m-y[1]),p=T(function(t,r){"number"==typeof r&&(r={x:r,y:r});return{x:function(e){return t.x+r.x*M.cos(e)},y:function(e){return t.y+r.y*M.sin(e)}}}({x:0,y:0},{x:y[5],y:y[5]}),b?-g:g,b?-f:f,.1,20).map(function(e){return(e=x.transform(e)).y=m-e.y,e}),a=null!=a?a:w.opts.line.size,l=String(l||w.opts.line.color).toLowerCase(),"dashed"!==(s=String(s||w.opts.line.style).toLowerCase())&&"dotted"!==s&&(s="solid"),h=L(w.nextColor=v(w.nextColor)),w.hitDict[h]={type:"arc",params:[e,t,r,n,i,o],extra:d||null},c=0,u=p.length;c+1<u;c++)w.drawLine(p[c],p[c+1],a,l,s,null,h);return w},drawBezier:function(e,t,r,n,i){var o,a,l,s=this,d=s.height(),h=T({x:m(e.map(g)),y:m(e.map(f).map(b(d)))},0,1,.5,20).map(b(d));for(t=null!=t?t:s.opts.line.size,r=String(r||s.opts.line.color).toLowerCase(),"dashed"!==(n=String(n||s.opts.line.style).toLowerCase())&&"dotted"!==n&&(n="solid"),o=L(s.nextColor=v(s.nextColor)),s.hitDict[o]={type:"bezier",points:e,extra:i||null},a=0,l=h.length;a+1<l;a++)s.drawLine(h[a],h[a+1],t,r,n,null,o);return s},fitText:function(e,t,r,n){var i,o,a,l,s=e.split(y),d=[],h=[],c=0;for(t.style.visibility="hidden",this.drawLayer.appendChild(t),i=0,o=s.length;i<o;i++)a=d.concat(s[i]),t.textContent=a.join(" "),r<(l=t.clientWidth)&&0<d.length?(h.push(d.join(" ")),d=[s[i]]):(d=a,c=M.max(c,l));return d.length&&(h.push(d.join(" ")),c=M.max(c,l)),this.drawLayer.removeChild(t),{lines:h,width:c,height:(h.length-1)*n}},createText:function(e,t,r,n,i){var o,a,l=document.createElement("div");return l.className="--plot-text",l.style.position="absolute",l.style.display="inline-block",l.style.overflow="hidden",l.style.boxSizing="border-box",l.style.margin="0px",l.style.padding="0px",l.style.border="none",l.style.background="none",l.style.color=r,l.style.fontSize=String(t)+"px",l.style.fontFamily="sans-serif",l.style.textAlign="left",l.style.lineHeight=String(i)+"px",(o=document.createElement("span")).style.display="inline-block",o.style.fontSize=String(t)+"px",o.style.fontFamily="sans-serif",o.style.padding="0px",o.style.margin="0px",o.style.border="none",(a=this.fitText(e,o,null==n?1/0:n,i)).el=l,a},drawText:function(e,t,r,n,i){var o,a,l=this;return r=null!=r?r:l.opts.text.size,n=String(n||l.opts.text.color).toLowerCase(),a=1.2*r,(o=l.createText(String(t),r,n,i,a)).el.style.left=String(e.x)+"px",o.el.style.top=String(e.y-r)+"px",o.lines.forEach(function(e){var t=document.createElement("span");t.style.position="relative",t.style.display="block",t.style.padding="0px",t.style.margin="0px",t.style.border="none",t.textContent=e,o.el.appendChild(t)}),l.drawLayer.appendChild(o.el),l},drawLabel:function(e,t,r,n){var i,o,a,l,s,d,h,c=this;return n=F(!0,B(c.opts),n||{}),i="auto"===t.x?1/0:t.x-n.label.padding.left-n.label.padding.right,o=1.2*n.label.text.size,h=c.createText(String(r),n.label.text.size,n.label.text.color,i,o),s="auto"===t.x?h.width+n.label.padding.left+n.label.padding.right:t.x,d="auto"===t.y?h.height+n.label.padding.top+n.label.padding.bottom:t.y,a=e.x,l=e.y,"left"===a?a=0:"right"===a?a=c.width()-s:"center"===a&&(a=(c.width()-s)/2),"top"===l?l=0:"bottom"===l?l=c.height()-d:"center"===l&&(l=(c.height()-d)/2),c.drawRect({x:a+s/2,y:l+d/2},{x:s,y:d},0,n.label.border.size,n.label.border.color,n.label.border.style,n.label.fill),a+=n.label.padding.left,l+=n.label.padding.top,h.el.style.left=String(a)+"px",h.el.style.top=String(l-n.label.text.size)+"px",h.lines.forEach(function(e){var t=document.createElement("span");t.style.position="relative",t.style.display="block",t.style.padding="0px",t.style.margin="0px",t.style.border="none",t.textContent=e,h.el.appendChild(t)}),c.drawLayer.appendChild(h.el),c}}),(E.Canvas=function e(t,r){if(!(this instanceof e))return new e(t,r);this.container=t,this.opts=F(!0,this.defaultOpts(),r||{})})[t]=F(new E,{constructor:E.Canvas,hitCanvas:null,dispose:function(){var e=this;return e.container&&e.hitCanvas&&e.container.removeChild(e.hitCanvas),e.hitCanvas=null,E[t].dispose.call(e)},init:function(){var e=this;return e.drawLayer||(e.nextColor=[0,0,0],e.hitDict={},e.hitTarget=null,e.hitCanvas=document.createElement("canvas"),e.hitCanvas.style.position="absolute",e.hitCanvas.style.left="0px",e.hitCanvas.style.top="0px",e.hitCanvas.style.width="100%",e.hitCanvas.style.height="100%",e.hitCanvas.style.display="block",e.hitCanvas.style.margin="0px",e.hitCanvas.style.padding="0px",e.hitCanvas.style.border="none",e.hitCanvas.style.visibility="hidden",e.container.appendChild(e.hitCanvas),e.drawLayer=document.createElement("canvas"),e.drawLayer.className="--plot-canvas",e.drawLayer.style.position="absolute",e.drawLayer.style.left="0px",e.drawLayer.style.top="0px",e.drawLayer.style.width="100%",e.drawLayer.style.height="100%",e.drawLayer.style.display="block",e.drawLayer.style.margin="0px",e.drawLayer.style.padding="0px",e.drawLayer.style.border="none",e.container.appendChild(e.drawLayer),e.hitCanvas.width=e.width(),e.hitCanvas.height=e.height(),e.drawLayer.width=e.width(),e.drawLayer.height=e.height(),e.handler=E.handler.bind(e),e.drawLayer.addEventListener("touchstart",e.handler,!1),e.drawLayer.addEventListener("mouseenter",e.handler,!1),e.drawLayer.addEventListener("click",e.handler,!1)),e},objAt:function(e,t){var r;return this.hitCanvas&&(r="#"+L(this.hitCanvas.getContext("2d").getImageData(M.round(t.left),M.round(t.top),1,1).data),s.call(this.hitDict,r))?this.hitDict[r]:null},resize:function(){var e=this;return e.drawLayer&&(e.hitCanvas.width=e.width(),e.hitCanvas.height=e.height(),e.drawLayer.width=e.width(),e.drawLayer.height=e.height()),e},clear:function(){var e=this,t=e.drawLayer.getContext("2d");return t.fillStyle=String(e.opts.background.color),t.fillRect(0,0,e.drawLayer.width,e.drawLayer.height),(t=e.hitCanvas.getContext("2d")).clearRect(0,0,e.hitCanvas.width,e.hitCanvas.height),e.nextColor=[0,0,0],e.hitDict={},e.hitTarget=null,e},background:function(e){return this.opts.background.color=e,this},drawPoint:function(e,t,r,n){var i,o=this,a=o.drawLayer.getContext("2d");return t=null!=t?t:o.opts.point.size,r=String(r||o.opts.point.color).toLowerCase(),a.resetTransform(),a.fillStyle=r,a.beginPath(),a.arc(e.x,e.y,t,0,2*M.PI),a.closePath(),a.fill(),i="#"+L(o.nextColor=v(o.nextColor)),o.hitDict[i]={type:"point",pos:e,extra:n||null},(a=o.hitCanvas.getContext("2d")).resetTransform(),a.fillStyle=i,a.beginPath(),a.arc(e.x,e.y,t,0,2*M.PI),a.closePath(),a.fill(),o},drawLine:function(e,t,r,n,i,o){var a,l=this,s=l.drawLayer.getContext("2d");return r=null!=r?r:l.opts.line.size,n=String(n||l.opts.line.color).toLowerCase(),"dashed"!==(i=String(i||l.opts.line.style).toLowerCase())&&"dotted"!==i&&(i="solid"),s.resetTransform(),s.beginPath(),"dashed"===i?s.setLineDash([4,4]):"dotted"===i?s.setLineDash([2,4]):s.setLineDash([]),s.lineWidth=r,s.strokeStyle=n,s.moveTo(e.x,e.y),s.lineTo(t.x,t.y),s.stroke(),s.closePath(),a="#"+L(l.nextColor=v(l.nextColor)),l.hitDict[a]={type:"line",pos:[e,t],extra:o||null},(s=l.hitCanvas.getContext("2d")).resetTransform(),s.beginPath(),s.lineWidth=r,s.strokeStyle=a,s.moveTo(e.x,e.y),s.lineTo(t.x,t.y),s.stroke(),s.closePath(),l},drawRect:function(e,t,r,n,i,o,a,l){var s,d=this,h=d.drawLayer.getContext("2d");return n=null!=n?n:d.opts.shape.border.size,i=String(i||d.opts.shape.border.color).toLowerCase(),"dashed"!==(o=String(o||d.opts.shape.border.style).toLowerCase())&&"dotted"!==o&&(o="solid"),a=String(null!=a?a:d.opts.shape.fill).toLowerCase(),h.resetTransform(),h.translate(e.x,e.y),h.rotate((r||0)*M.PI/180),h.beginPath(),0<n&&("dashed"===o?h.setLineDash([4,4]):"dotted"===o?h.setLineDash([2,4]):h.setLineDash([]),h.lineWidth=n,h.strokeStyle=i),h.rect(-t.x/2,-t.y/2,t.x,t.y),a&&"none"!==a&&(h.fillStyle=a,h.fill()),0<n&&h.stroke(),h.closePath(),h.resetTransform(),s="#"+L(d.nextColor=v(d.nextColor)),d.hitDict[s]={type:"rect",center:e,side:t,rotation:r,extra:l||null},(h=d.hitCanvas.getContext("2d")).resetTransform(),h.translate(e.x,e.y),h.rotate((r||0)*M.PI/180),h.beginPath(),0<n&&(h.lineWidth=n,h.strokeStyle=s),h.rect(-t.x/2,-t.y/2,t.x,t.y),h.fillStyle=s,h.fill(),0<n&&h.stroke(),h.closePath(),h.resetTransform(),d},drawEllipse:function(e,t,r,n,i,o,a,l){var s,d=this,h=d.drawLayer.getContext("2d");return n=null!=n?n:d.opts.shape.border.size,i=String(i||d.opts.shape.border.color).toLowerCase(),"dashed"!==(o=String(o||d.opts.shape.border.style).toLowerCase())&&"dotted"!==o&&(o="solid"),a=String(null!=a?a:d.opts.shape.fill).toLowerCase(),h.resetTransform(),h.beginPath(),0<n&&("dashed"===o?h.setLineDash([4,4]):"dotted"===o?h.setLineDash([2,4]):h.setLineDash([]),h.lineWidth=n,h.strokeStyle=i),h.ellipse(e.x,e.y,t.x,t.y,(r||0)*M.PI/180,0,2*M.PI,0),a&&"none"!==a&&(h.fillStyle=a,h.fill()),0<n&&h.stroke(),h.closePath(),h.resetTransform(),s="#"+L(d.nextColor=v(d.nextColor)),d.hitDict[s]={type:"ellipse",center:e,radius:t,rotation:r,extra:l||null},(h=d.hitCanvas.getContext("2d")).resetTransform(),h.beginPath(),0<n&&(h.lineWidth=n,h.strokeStyle=s),h.ellipse(e.x,e.y,t.x,t.y,(r||0)*M.PI/180,0,2*M.PI,0),h.fillStyle=s,h.fill(),0<n&&h.stroke(),h.closePath(),h.resetTransform(),d},drawArc:function(e,t,r,n,i,o,a,l,s,d){var h,c,u=this,y=u.drawLayer.getContext("2d");return a=null!=a?a:u.opts.line.size,l=String(l||u.opts.line.color).toLowerCase(),s=String(s||u.opts.line.style).toLowerCase(),c=z(e,t,r||0,n?1:0,i?1:0,o),y.resetTransform(),y.beginPath(),"dashed"===s?y.setLineDash([4,4]):"dotted"===s?y.setLineDash([2,4]):y.setLineDash([]),y.lineWidth=a,y.strokeStyle=l,y.translate(c[0],c[1]),y.rotate(c[2]),y.scale(c[3],c[4]),y.arc(0,0,c[5],c[6],c[6]+c[7],1-c[8]),y.stroke(),y.closePath(),y.resetTransform(),h="#"+L(u.nextColor=v(u.nextColor)),u.hitDict[h]={type:"arc",params:[e,t,r,n,i,o],extra:d||null},(y=u.hitCanvas.getContext("2d")).resetTransform(),y.beginPath(),y.lineWidth=a,y.strokeStyle=h,y.translate(c[0],c[1]),y.rotate(c[2]),y.scale(c[3],c[4]),y.arc(0,0,c[5],c[6],c[6]+c[7],1-c[8]),y.stroke(),y.closePath(),y.resetTransform(),u},drawBezier:function(e,t,r,n,i){var o,a=this,l=a.drawLayer.getContext("2d");return t=null!=t?t:a.opts.line.size,r=String(r||a.opts.line.color).toLowerCase(),"dashed"!==(n=String(n||a.opts.line.style).toLowerCase())&&"dotted"!==n&&(n="solid"),l.resetTransform(),l.beginPath(),"dashed"===n?l.setLineDash([4,4]):"dotted"===n?l.setLineDash([2,4]):l.setLineDash([]),l.lineWidth=t,l.strokeStyle=r,l.moveTo(e[0].x,e[0].y),l.bezierCurveTo(e[1].x,e[1].y,e[2].x,e[2].y,e[3].x,e[3].y),l.stroke(),l.closePath(),o="#"+L(a.nextColor=v(a.nextColor)),a.hitDict[o]={type:"bezier",points:e,extra:i||null},(l=a.hitCanvas.getContext("2d")).resetTransform(),l.beginPath(),l.lineWidth=t,l.strokeStyle=o,l.moveTo(e[0].x,e[0].y),l.bezierCurveTo(e[1].x,e[1].y,e[2].x,e[2].y,e[3].x,e[3].y),l.stroke(),l.closePath(),a},fitText:function(e,t,r,n){var i,o,a,l,s=e.split(y),d=[],h=[],c=0;for(i=0,o=s.length;i<o;i++)a=d.concat(s[i]),r<(l=t.measureText(a.join(" ")).width)&&0<d.length?(h.push(d.join(" ")),d=[s[i]]):(d=a,c=M.max(c,l));return d.length&&(h.push(d.join(" ")),c=M.max(c,l)),{lines:h,width:c,height:(h.length-1)*n}},createText:function(e,t,r,n,i){var o,a=this.drawLayer.getContext("2d");return a.resetTransform(),a.font=String(t)+"px sans-serif",a.fillStyle=r,(o=this.fitText(e,a,null==n?1/0:n,i)).el=a,o},drawText:function(t,e,r,n,i){var o,a,l=0;return r=null!=r?r:this.opts.text.size,n=String(n||this.opts.text.color).toLowerCase(),a=1.2*r,(o=this.createText(String(e),r,n,i,a)).lines.forEach(function(e){o.el.fillText(e,t.x,t.y+l),l+=a}),this},drawLabel:function(e,t,r,n){var i,o,a,l,s,d,h,c=this,u=0;return n=F(!0,B(c.opts),n||{}),i="auto"===t.x?1/0:t.x-n.label.padding.left-n.label.padding.right,o=1.2*n.label.text.size,(h=c.createText(String(r),n.label.text.size,n.label.text.color,i,o)).el.save(),s="auto"===t.x?h.width+n.label.padding.left+n.label.padding.right:t.x,d="auto"===t.y?h.height+n.label.padding.top+n.label.padding.bottom:t.y,a=e.x,l=e.y,"left"===a?a=0:"right"===a?a=c.width()-s:"center"===a&&(a=(c.width()-s)/2),"top"===l?l=0:"bottom"===l?l=c.height()-d:"center"===l&&(l=(c.height()-d)/2),c.drawRect({x:a+s/2,y:l+d/2},{x:s,y:d},0,n.label.border.size,n.label.border.color,n.label.border.style,n.label.fill),a+=n.label.padding.left,l+=n.label.padding.top,h.el.restore(),h.lines.forEach(function(e){h.el.fillText(e,a,l+u),u+=o}),c}}),(E.Svg=function e(t,r){if(!(this instanceof e))return new e(t,r);this.container=t,this.opts=F(!0,this.defaultOpts(),r||{})})[t]=F(new E,{constructor:E.Svg,NS:"http://www.w3.org/2000/svg",init:function(){var e=this;return e.drawLayer||(e.nextColor=[0,0,0],e.hitDict={},e.hitTarget=null,e.drawLayer=document.createElementNS(e.NS,"svg"),e.drawLayer.setAttribute("class","--plot-svg"),e.drawLayer.style.position="absolute",e.drawLayer.style.left="0px",e.drawLayer.style.top="0px",e.drawLayer.style.width="100%",e.drawLayer.style.height="100%",e.drawLayer.style.display="block",e.drawLayer.style.overflow="hidden",e.drawLayer.style.margin="0px",e.drawLayer.style.padding="0px",e.drawLayer.style.border="none",e.drawLayer.style.backgroundColor=e.opts.background.color,e.container.appendChild(e.drawLayer),e.drawLayer.setAttribute("viewBox","0 0 "+String(e.width())+" "+String(e.height())),e.handler=E.handler.bind(e),e.drawLayer.addEventListener("touchstart",e.handler,!1),e.drawLayer.addEventListener("mouseenter",e.handler,!1),e.drawLayer.addEventListener("click",e.handler,!1)),e},objAt:function(e,t){var r=e.target?e.target.hitId:null;return r&&s.call(this.hitDict,r)?this.hitDict[r]:null},resize:function(){var e=this;return e.drawLayer&&e.drawLayer.setAttribute("viewBox","0 0 "+String(e.width())+" "+String(e.height())),e},clear:function(){var e=this;return e.drawLayer.innerHTML="",e.nextColor=[0,0,0],e.hitDict={},e.hitTarget=null,e},background:function(e){return this.opts.background.color=e,this.drawLayer.style.backgroundColor=this.opts.background.color,this},drawPoint:function(e,t,r,n){var i=this,o=document.createElementNS(i.NS,"circle");return t=null!=t?t:i.opts.point.size,r=String(r||i.opts.point.color).toLowerCase(),o.setAttribute("class","--plot-point"),o.setAttribute("cx",String(e.x)),o.setAttribute("cy",String(e.y)),o.setAttribute("r",String(t)),o.setAttribute("stroke-width","1px"),o.setAttribute("stroke",r),o.setAttribute("fill",r),o.hitId=L(i.nextColor=v(i.nextColor)),i.hitDict[o.hitId]={type:"point",pos:e,extra:n||null},i.drawLayer.appendChild(o),i},drawLine:function(e,t,r,n,i,o){var a=this,l=document.createElementNS(a.NS,"line");return r=null!=r?r:a.opts.line.size,n=String(n||a.opts.line.color).toLowerCase(),"dashed"!==(i=String(i||a.opts.line.style).toLowerCase())&&"dotted"!==i&&(i="solid"),l.setAttribute("class","--plot-line"),l.setAttribute("x1",String(e.x)),l.setAttribute("y1",String(e.y)),l.setAttribute("x2",String(t.x)),l.setAttribute("y2",String(t.y)),l.setAttribute("stroke-width",String(r)+"px"),l.setAttribute("stroke",n),"dashed"===i?l.setAttribute("stroke-dasharray","4 4"):"dotted"===i&&l.setAttribute("stroke-dasharray","2 4"),l.hitId=L(a.nextColor=v(a.nextColor)),a.hitDict[l.hitId]={type:"line",pos:[e,t],extra:o||null},a.drawLayer.appendChild(l),a},drawRect:function(e,t,r,n,i,o,a,l){var s=this,d=document.createElementNS(s.NS,"rect");return n=null!=n?n:s.opts.shape.border.size,i=String(i||s.opts.shape.border.color).toLowerCase(),"dashed"!==(o=String(o||s.opts.shape.border.style).toLowerCase())&&"dotted"!==o&&(o="solid"),a=String(null!=a?a:s.opts.shape.fill).toLowerCase(),d.setAttribute("class","--plot-rectangle"),d.setAttribute("x",String(e.x-t.x/2)),d.setAttribute("y",String(e.y-t.y/2)),d.setAttribute("width",String(t.x)),d.setAttribute("height",String(t.y)),d.setAttribute("transform","rotate("+String(r||0)+" "+String(e.x)+" "+String(e.y)+")"),0<n&&(d.setAttribute("stroke-width",String(n)+"px"),d.setAttribute("stroke",i),"dashed"===o?d.setAttribute("stroke-dasharray","4 4"):"dotted"===o&&d.setAttribute("stroke-dasharray","2 4")),d.setAttribute("fill",a||"none"),d.hitId=L(s.nextColor=v(s.nextColor)),s.hitDict[d.hitId]={type:"rect",center:e,side:t,rotation:r,extra:l||null},s.drawLayer.appendChild(d),s},drawEllipse:function(e,t,r,n,i,o,a,l){var s=this,d=document.createElementNS(s.NS,"ellipse");return n=null!=n?n:s.opts.shape.border.size,i=String(i||s.opts.shape.border.color).toLowerCase(),"dashed"!==(o=String(o||s.opts.shape.border.style).toLowerCase())&&"dotted"!==o&&(o="solid"),a=String(null!=a?a:s.opts.shape.fill).toLowerCase(),d.setAttribute("class","--plot-ellipse"),d.setAttribute("cx",String(e.x)),d.setAttribute("cy",String(e.y)),d.setAttribute("rx",String(t.x)),d.setAttribute("ry",String(t.y)),d.setAttribute("transform","rotate("+String(r||0)+" "+String(e.x)+" "+String(e.y)+")"),0<n&&(d.setAttribute("stroke-width",String(n)+"px"),d.setAttribute("stroke",i),"dashed"===o?d.setAttribute("stroke-dasharray","4 4"):"dotted"===o&&d.setAttribute("stroke-dasharray","2 4")),d.setAttribute("fill",a||"none"),d.hitId=L(s.nextColor=v(s.nextColor)),s.hitDict[d.hitId]={type:"ellipse",center:e,radius:t,rotation:r,extra:l||null},s.drawLayer.appendChild(d),s},drawArc:function(e,t,r,n,i,o,a,l,s,d){var h=this,c=document.createElementNS(h.NS,"path");return a=null!=a?a:h.opts.line.size,l=String(l||h.opts.line.color).toLowerCase(),"dashed"!==(s=String(s||h.opts.line.style).toLowerCase())&&"dotted"!==s&&(s="solid"),c.setAttribute("class","--plot-arc"),c.setAttribute("d","M "+String(e.x)+" "+String(e.y)+" A "+String(t.x)+" "+String(t.y)+" "+String(r||0)+" "+String(n?1:0)+" "+String(i?1:0)+" "+String(o.x)+" "+String(o.y)),c.setAttribute("stroke-width",String(a)+"px"),c.setAttribute("stroke",l),c.setAttribute("fill","none"),"dashed"===s?c.setAttribute("stroke-dasharray","4 4"):"dotted"===s&&c.setAttribute("stroke-dasharray","2 4"),c.hitId=L(h.nextColor=v(h.nextColor)),h.hitDict[c.hitId]={type:"arc",params:[e,t,r,n,i,o],extra:d||null},h.drawLayer.appendChild(c),h},drawBezier:function(e,t,r,n,i){var o=this,a=document.createElementNS(o.NS,"path");return t=null!=t?t:o.opts.line.size,r=String(r||o.opts.line.color).toLowerCase(),"dashed"!==(n=String(n||o.opts.line.style).toLowerCase())&&"dotted"!==n&&(n="solid"),a.setAttribute("class","--plot-bezier"),a.setAttribute("d","M "+String(e[0].x)+","+String(e[0].y)+" C "+String(e[1].x)+","+String(e[1].y)+" "+String(e[2].x)+","+String(e[2].y)+" "+String(e[3].x)+","+String(e[3].y)),a.setAttribute("stroke-width",String(t)+"px"),a.setAttribute("stroke",r),"dashed"===n?a.setAttribute("stroke-dasharray","4 4"):"dotted"===n&&a.setAttribute("stroke-dasharray","2 4"),a.hitId=L(o.nextColor=v(o.nextColor)),o.hitDict[a.hitId]={type:"bezier",points:e,extra:i||null},o.drawLayer.appendChild(a),o},fitText:function(e,t,r,n){var i,o,a,l,s,d=e.split(y),h=[],c=[],u=0;for(t.style.visibility="hidden",this.drawLayer.appendChild(t),i=0,o=d.length;i<o;i++)a=h.concat(d[i]),t.textContent=a.join(" "),l=t.getBBox(),r<(s=M.round(l.width))&&0<h.length?(c.push(h.join(" ")),h=[d[i]]):(h=a,u=M.max(u,s));return h.length&&(c.push(h.join(" ")),u=M.max(u,s)),this.drawLayer.removeChild(t),{lines:c,width:u,height:(c.length-1)*n}},createText:function(e,t,r,n,i){var o,a=document.createElementNS(this.NS,"text");return a.setAttribute("class","--plot-text"),a.setAttribute("fill",r),a.style.fontSize=String(t)+"px",a.style.fontFamily="sans-serif",(o=this.fitText(e,a.cloneNode(!1),null==n?1/0:n,i)).el=a,o},drawText:function(r,e,t,n,i){var o,a,l=this,s=0;return t=null!=t?t:l.opts.text.size,n=String(n||l.opts.text.color).toLowerCase(),a=1.2*t,(o=l.createText(String(e),t,n,i,a)).el.setAttribute("x",r.x),o.el.setAttribute("y",r.y),o.lines.forEach(function(e){var t=document.createElementNS(l.NS,"tspan");t.setAttribute("x",r.x),t.setAttribute("dy",s),t.textContent=e,o.el.appendChild(t),0===s&&(s=a)}),l.drawLayer.appendChild(o.el),l},drawLabel:function(e,t,r,n){var i,o,a,l,s,d,h,c=this,u=0;return n=F(!0,B(c.opts),n||{}),i="auto"===t.x?1/0:t.x-n.label.padding.left-n.label.padding.right,o=1.2*n.label.text.size,h=c.createText(String(r),n.label.text.size,n.label.text.color,i,o),s="auto"===t.x?h.width+n.label.padding.left+n.label.padding.right:t.x,d="auto"===t.y?h.height+n.label.padding.top+n.label.padding.bottom:t.y,a=e.x,l=e.y,"left"===a?a=0:"right"===a?a=c.width()-s:"center"===a&&(a=(c.width()-s)/2),"top"===l?l=0:"bottom"===l?l=c.height()-d:"center"===l&&(l=(c.height()-d)/2),c.drawRect({x:a+s/2,y:l+d/2},{x:s,y:d},0,n.label.border.size,n.label.border.color,n.label.border.style,n.label.fill),a+=n.label.padding.left,l+=n.label.padding.top,h.el.setAttribute("x",a),h.el.setAttribute("y",l),h.lines.forEach(function(e){var t=document.createElementNS(c.NS,"tspan");t.setAttribute("x",a),t.setAttribute("dy",u),t.textContent=e,h.el.appendChild(t),0===u&&(u=o)}),c.drawLayer.appendChild(h.el),c}}),D[t]={constructor:D,renderer:null,opts:null,dispose:function(){var e=this;return e.tooltip&&document.body.removeChild(e.tooltip),e.renderer=null,e.tooltip=null,e.opts=null,e},defaultOpts:function(){return{tolerance:.001,depth:20,npoints:60,background:{color:"#ffffff"},padding:{top:20,right:20,bottom:20,left:20},text:{size:14,color:"#000000"},point:{size:4,color:"#000000"},line:{size:1,color:"#000000",style:"solid"},shape:{border:{size:1,color:"#000000",style:"solid"},fill:"none"},label:{text:{size:14,color:"#000000"},border:{size:1,color:"#000000",style:"solid"},fill:"none",padding:{top:20,right:20,bottom:20,left:20}},colors:null,labels:null,axes:{x:{size:2,color:"#000000",style:"solid",ticks:{size:1,color:"rgba(0,0,0,0.5)",style:"dashed",text:{size:16,color:"#000000"},step:"auto",scale:"linear"}},y:{size:2,color:"#000000",style:"solid",ticks:{size:1,color:"rgba(0,0,0,0.5)",style:"dashed",text:{size:16,color:"#000000"},step:"auto",scale:"linear"}}}}},boundingBox:function(e){var t,r,n,i,o,a=e.length;if("number"==typeof e[0]){for(r=1/0,i=-1/0,t=0;t<a;t++)l(e[t])&&(e[t]<r&&(r=e[t]),e[t]>i&&(i=e[t]));return{min:r,max:i}}for(n=r=1/0,o=i=-1/0,t=0;t<a;t++)H.isFinite(e[t])&&(e[t].x<r&&(r=e[t].x),e[t].y<n&&(n=e[t].y),e[t].x>i&&(i=e[t].x),e[t].y>o&&(o=e[t].y));return{min:{x:r,y:n},max:{x:i,y:o}}},sample:function(e,t,r,n){var i,o,a,l,s;for(n=F(B(this.opts),n||{}),null==t&&(t=0),null==r&&(r=t+1),e=h(e.x)&&h(e.y)?e:{x:O,y:e},l=(r-t)/(s=M.ceil(2*n.npoints/3)),i=[],a=0;a<s;a++)o=T(e,t+a*l,t+(a+1)*l,n.tolerance,n.depth),i=i.concat(0<a?o.slice(1):o);return i},width:function(){return this.renderer.init().width()},height:function(){return this.renderer.init().height()},resize:function(){return this.renderer.init().resize(),this},clear:function(){return this.renderer.init().background(this.opts.background.color).clear(),this},text:function(e,t,r){return r=F(!0,B(this.opts),r||{}),this.renderer.init(),this.renderer.drawText(e,t,r.text.size,r.text.color),this},point:function(e,t){var r,n;for(t=F(!0,B(this.opts),t||{}),this.renderer.init(),Y(e)||(e=[e]),r=0,n=e.length;r<n;r++)H.isFinite(e[r])&&this.renderer.drawPoint(e[r],t.point.size,t.point.color);return this},line:function(e,t){var r,n;for(t=F(!0,B(this.opts),t||{}),this.renderer.init(),Y(e)||(e=[e]),r=0,n=e.length;r+1<n;r++)H.isFinite(e[r])&&H.isFinite(e[r+1])&&this.renderer.drawLine(e[r],e[r+1],t.line.size,t.line.color,t.line.style);return this},rectangle:function(t,r,n,i){var o=this;return o.renderer.init(),arguments.length<=2&&Y(t)?(i=F(!0,B(o.opts),r||{}),t.forEach(function(e){i=F(!0,i,e[3]||{}),n=e[2],"number"==typeof(r=e[1])&&(r={x:r,y:r}),t=e[0],o.renderer.drawRect(t,r,n||0,i.shape.border.size,i.shape.border.color,i.shape.border.style,i.shape.fill)})):(i=F(!0,B(o.opts),i||{}),o.renderer.drawRect(t,r,n||0,i.shape.border.size,i.shape.border.color,i.shape.border.style,i.shape.fill)),o},ellipse:function(t,r,n,i){var o=this;return o.renderer.init(),arguments.length<=2&&Y(t)?(i=F(!0,B(o.opts),r||{}),t.forEach(function(e){i=F(!0,i,e[3]||{}),n=e[2],"number"==typeof(r=e[1])&&(r={x:r,y:r}),t=e[0],o.renderer.drawEllipse(t,r,n||0,i.shape.border.size,i.shape.border.color,i.shape.border.style,i.shape.fill)})):(i=F(!0,B(o.opts),i||{}),"number"==typeof r&&(r={x:r,y:r}),o.renderer.drawEllipse(t,r,n||0,i.shape.border.size,i.shape.border.color,i.shape.border.style,i.shape.fill)),o},arc:function(t,r,n,i,o,a,l){var s=this;return s.renderer.init(),arguments.length<=2&&Y(t)?(l=F(!0,B(s.opts),r||{}),t.forEach(function(e){l=F(!0,l,e[6]||{}),a=e[5],o=e[4],i=e[3],n=e[2],"number"==typeof(r=e[1])&&(r={x:r,y:r}),t=e[0],s.renderer.drawArc(t,r,+(n||0),i?1:0,o?1:0,a,l.line.size,l.line.color,l.line.style)})):(l=F(!0,B(s.opts),l||{}),"number"==typeof r&&(r={x:r,y:r}),s.renderer.drawArc(t,r,+(n||0),i?1:0,o?1:0,a,l.line.size,l.line.color,l.line.style)),s},bezier:function(e,t){var r=this;return t=F(!0,B(r.opts),t||{}),r.renderer.init(),Y(e)||(e=[e]),2===e.length?r.renderer.drawLine(e[0],e[1],t.line.size,t.line.color,t.line.style):4<=e.length&&r.renderer.drawBezier(e,t.line.size,t.line.color,t.line.style),r},spline:function(e,t){Y(e)||(e=[e]);var r,n,i,o=this,a={x:C(e.map(g)),y:C(e.map(f))};if(n=(i=a.x.reduce(function(e,t,n){return t.reduce(function(e,t,r){return e.push(new H(a.x[n][r],a.y[n][r])),e},e)},[])).length,t=F(!0,B(o.opts),t||{}),o.renderer.init(),2===n)o.renderer.drawLine(i[0],i[1],t.line.size,t.line.color,t.line.style);else if(4<=i.length)for(r=0;r<n;r+=4)o.renderer.drawBezier([i[r],i[r+1],i[r+2],i[r+3]],t.line.size,t.line.color,t.line.style);return o},label:function(e,t,r,n){return this.renderer.init(),this.renderer.drawLabel(e,t,r,F(!0,B(this.opts),n||{})),this},graph:function(e,t,r,n){var i,o,a,l,s,d,h,c,u,y,p,x,g,f,b,w,m,v,L,S,C,k,z,T,A,E,D,P,I=this,N=[],j=[],R=[],X=[];if((n=F(!0,B(I.opts),n||{})).axes&&n.axes.x&&n.axes.x.ticks&&n.axes.x.ticks.scale,b=O,n.axes&&n.axes.y&&n.axes.y.ticks&&n.axes.y.ticks.scale,w=O,y=M.max(0,n.padding&&n.padding.left||0),p=M.max(0,n.padding&&n.padding.right||0),x=M.max(0,n.padding&&n.padding.top||0),g=M.max(0,n.padding&&n.padding.bottom||0),o=(i=Y(e)?e:I.sample(e,t,r,n)).map(function(e){return e.apply(b,w)}),I.renderer.init(),l=I.renderer.width(),s=I.renderer.height(),d=(f=I.boundingBox(o)).max.x-f.min.x+1e-6,h=f.max.y-f.min.y+1e-6,u=M.min((l-y-p)/d,(s-x-g)/h),c=(a=(new q).translate(-f.min.x,-f.min.y).scale(u).translate(y+(l-y-p-u*d)/2,x+(s-x-g-u*h)/2)).transform(new H(0,0)).apply(M.round),n.axes){if(n.axes.y&&n.axes.y.ticks&&(S="auto"===n.axes.y.ticks.step?h/8:n.axes.y.ticks.step,0<(z=M.round(u*S))))for(C=c.y,E=0,s<C&&(E-=D=M.ceil((C-s)/z),C-=D*z),C<0&&(E+=D=M.ceil(-C/z),C+=D*z),T=C===c.y?1:0,k=C+(A=-1)*z,m=w(C+=T*z),v=w(k);m<=s-g||x<=v;)x<=m&&m<=s-g&&(I.renderer.drawLine({x:y,y:s-m},{x:l-p,y:s-m},n.axes.y.ticks.size,n.axes.y.ticks.color,n.axes.y.ticks.style),j.push({y:s-m,v:(E+T)*S})),x<=v&&v<=s-g&&(I.renderer.drawLine({x:y,y:s-v},{x:l-p,y:s-v},n.axes.y.ticks.size,n.axes.y.ticks.color,n.axes.y.ticks.style),X.push({y:s-v,v:(E+A)*S})),k-=z,T++,A--,m=w(C+=z),v=w(k);if(n.axes.x&&n.axes.x.ticks&&(L="auto"===n.axes.x.ticks.step?d/8:n.axes.x.ticks.step,0<(z=M.round(u*L))))for(E=0,l<(C=c.x)&&(E-=D=M.ceil((C-l)/z),C-=D*z),C<0&&(E+=D=M.ceil(-C/z),C+=D*z),T=C===c.x?1:0,k=C+(A=-1)*z,m=b(C+=T*z),v=b(k);m<=l-p||y<=v;)y<=m&&m<=l-p&&(I.renderer.drawLine({x:m,y:s-g},{x:m,y:x},n.axes.x.ticks.size,n.axes.x.ticks.color,n.axes.x.ticks.style),N.push({x:m,v:(E+T)*L})),y<=v&&v<=s-p&&(I.renderer.drawLine({x:v,y:s-g},{x:v,y:x},n.axes.x.ticks.size,n.axes.x.ticks.color,n.axes.x.ticks.style),R.push({x:v,v:(E+A)*L})),k-=z,T++,A--,m=b(C+=z),v=b(k);n.axes.x&&c.y>=x&&c.y<=s-g&&I.renderer.drawLine({x:y,y:s-c.y},{x:l-p,y:s-c.y},n.axes.x.size,n.axes.x.color,n.axes.x.style),n.axes.y&&c.x>=y&&c.x<=l-p&&I.renderer.drawLine({x:c.x,y:x},{x:c.x,y:s-g},n.axes.y.size,n.axes.y.color,n.axes.y.style)}for(P=function(e,t,r,n){var i,o=I.tooltip;if("enter"===e)o.classList.remove("--plot-hide-tooltip"),o.classList.add("--plot-show-tooltip");else if("leave"===e)return o.classList.remove("--plot-show-tooltip"),void o.classList.add("--plot-hide-tooltip");i=(r.localX-t.pos[0].x)/(t.pos[1].x-t.pos[0].x),o.innerHTML="x: "+String(W(t.extra.p1.x,t.extra.p2.x,i))+"<br />y: "+String(W(t.extra.p1.y,t.extra.p2.y,i)),o.style.left=String(r.pageX)+"px",o.style.top=String(r.pageY)+"px"},T=0,E=(o=(o=o.map(function(e){return a.transform(e)})).map(function(e){return e.y=s-e.y,e})).length;T+1<E;T++)H.isFinite(o[T])&&H.isFinite(o[T+1])&&I.renderer.drawLine(o[T],o[T+1],n.line.size,n.line.color,n.line.style,{p1:i[T],p2:i[T+1],listener:{enter:P,leave:P,move:P}});if(n.axes){if(n.axes.x&&n.axes.x.ticks&&n.axes.x.ticks.text&&0<n.axes.x.ticks.text.size&&(N.length||R.length)){for(C=c.y>=x&&c.y<=s-g?s-c.y-5:s-g-5,z=M.ceil(N.length/3),T=0;T<N.length;T+=z)0!==N[T].v&&I.renderer.drawText({x:N[T].x+2,y:C},N[T].v,n.axes.x.ticks.text.size,n.axes.x.ticks.text.color);for(z=M.ceil(R.length/3),T=0;T<R.length;T+=z)0!==R[T].v&&I.renderer.drawText({x:R[T].x+2,y:C},R[T].v,n.axes.x.ticks.text.size,n.axes.x.ticks.text.color)}if(n.axes.y&&n.axes.y.ticks&&n.axes.y.ticks.text&&0<n.axes.y.ticks.text.size&&(j.length||X.length)){for(C=c.x>=y&&c.x<=l-p?c.x+5:y+5,z=M.ceil(j.length/3),T=0;T<j.length;T+=z)0!==j[T].v&&I.renderer.drawText({x:C,y:j[T].y-2},j[T].v,n.axes.y.ticks.text.size,n.axes.y.ticks.text.color);for(z=M.ceil(X.length/3),T=0;T<X.length;T+=z)0!==X[T].v&&I.renderer.drawText({x:C,y:X[T].y-2},X[T].v,n.axes.y.ticks.text.size,n.axes.y.ticks.text.color)}}return I},chart:function(e,t,r){var n,i,o,a,l,s,d,h,c,u,y,p,x,g,f,b,w,m,v,L,S,C,k,z,T,A,E,D,P,I=this,N=[],j=[];if(e=String(e||"vbar").toLowerCase(),(r=F(!0,B(I.opts),r||{})).colors=r.colors||R(t.length),r.labels=r.labels||function(e){var t,r=new Array(e);for(t=0;t<e;t++)r[t]="Entry: "+String(t+1);return r}(t.length),z=M.max(0,r.padding&&r.padding.left||0),T=M.max(0,r.padding&&r.padding.right||0),A=M.max(0,r.padding&&r.padding.top||0),E=M.max(0,r.padding&&r.padding.bottom||0),v="hbar"===e?(r.axes&&r.axes.x?r.axes.x.ticks:null)||null:(r.axes&&r.axes.y?r.axes.y.ticks:null)||null,n=t.map(function(e,t){return new H(t,e)}),k=I.boundingBox(n),b=n.length,I.renderer.init(),i=I.renderer.width(),o=I.renderer.height(),p="hbar"===e?(L=i,S=z,C=T,v&&v.text&&0<v.text.size&&(D=o-E-2,E+=2*v.text.size),M.max(1,(o-E-A)/(b+.2*(b-1)))):(L=o,S=A,C=E,v&&v.text&&0<v.text.size&&(D=z+2,z+=2*v.text.size),"line"===e?M.max(1,(i-z-T)/b):M.max(1,(i-z-T)/(b+.2*(b-1)))),d=k.min.y<0?-k.min.y:0,s=S+(l=(L-S-C)/(h=k.max.y+d))*d,x=p/2,a=(new q).scale(1,l),r.axes&&v&&(m="auto"===v.step?h/8:v.step,0<(y=M.round(l*m))))for(b=0,L<(c=s)&&(b-=w=M.ceil((c-L)/y),c-=w*y),c<0&&(b+=w=M.ceil(-c/y),c+=w*y),u=c+(f=-1)*y,c+=(g=c===s?1:0)*y;c<=L-C||S<=u;)S<=c&&c<=L-C&&(I.renderer.drawLine("hbar"===e?{y:A,x:c}:{x:z,y:o-c},"hbar"===e?{y:o-E,x:c}:{x:i-T,y:o-c},v.size,v.color,v.style),N.push({p:"hbar"===e?c:o-c,v:(b+g)*m})),S<=u&&u<=L-C&&(I.renderer.drawLine("hbar"===e?{y:A,x:u}:{x:z,y:o-u},"hbar"===e?{y:o-E,x:u}:{x:i-T,y:o-u},v.size,v.color,v.style),j.push({p:"hbar"===e?u:o-u,v:(b+f)*m})),c+=y,u-=y,g++,f--;if(n=n.map(function(e){return a.transform(e)}),P=function(e,t,r,n){var i=I.tooltip;if("enter"===e)i.classList.remove("--plot-hide-tooltip"),i.classList.add("--plot-show-tooltip"),i.innerHTML=t.extra.label+"<br />"+t.extra.value;else if("leave"===e)return i.classList.remove("--plot-show-tooltip"),void i.classList.add("--plot-hide-tooltip");i.style.left=String(r.pageX)+"px",i.style.top=String(r.pageY)+"px"},"line"===e){for(g=0,b=n.length,y=0;g+1<b;g++,y+=p)H.isFinite(n[g])&&H.isFinite(n[g+1])&&I.renderer.drawLine({x:z+y,y:o-s-n[g].y},{x:z+y+p,y:o-s-n[g+1].y},r.line.size,r.line.color,r.line.style);for(g=0,b=n.length,y=0;g<b;g++,y+=p)H.isFinite(n[g])&&I.renderer.drawPoint({x:z+y,y:o-s-n[g].y},r.point.size,r.colors[g],{label:r.labels[g],value:String(t[g]),listener:{enter:P,leave:P,move:P}})}else for(g=0,b=n.length,y=0;g<b;g++,y+=p)H.isFinite(n[g])&&("hbar"===e?I.renderer.drawRect({y:A+x+y+(0<g?.2*y:0),x:s+n[g].y/2},{y:p,x:M.abs(n[g].y)},0,0,"transparent","solid",r.colors[g],{label:r.labels[g],value:String(t[g]),listener:{enter:P,leave:P,move:P}}):I.renderer.drawRect({x:z+x+y+(0<g?.2*y:0),y:o-s-n[g].y/2},{x:p,y:M.abs(n[g].y)},0,0,"transparent","solid",r.colors[g],{label:r.labels[g],value:String(t[g]),listener:{enter:P,leave:P,move:P}}));if(r.axes&&v&&v.text&&0<v.text.size&&(N.length||j.length)){for(c=D,y=M.ceil(N.length/3),g=0;g<N.length;g+=y)0!==N[g].v&&I.renderer.drawText("hbar"===e?{x:N[g].p+2,y:c}:{y:N[g].p-2,x:c},N[g].v,v.text.size,v.text.color);for(y=M.ceil(j.length/3),g=0;g<j.length;g+=y)0!==j[g].v&&I.renderer.drawText("hbar"===e?{x:j[g].p+2,y:c}:{y:j[g].p-2,x:c},j[g].v,v.text.size,v.text.color)}return I}},D.VERSION="1.0.0",D.Util={clone:B,extend:F,debounce:function(r,n){var i=null;return function(){var e=this,t=arguments;clearTimeout(i),i=setTimeout(function(){r.apply(e,t)},n)}},subdivide:T,hex2rgb:function(e){return[(e=parseInt("#"===e.charAt(0)?e.slice(1):e,16))>>16&255,e>>8&255,255&e]},rgb2hex:L,hsb2rgb:c,rgb2hsb:function(e){var t=0,r=0,n=0,i=e[0],o=e[1],a=e[2],l=M.min(i,o,a),s=M.max(i,o,a),d=s-l;n=s;t=0!=(r=0!=s?255*d/s:0)?i===s?(o-a)/d:o===s?2+(a-i)/d:4+(i-o)/d:-1;(t*=60)<0&&(t+=360);return r=100*r/255,n=100*n/255,[M.round(t),M.round(r),M.round(n)]},palette:R},D.Point=H,D.Matrix=q,D.Renderer=E,D}.call(e)||1)&&"function"==typeof define&&define.amd&&define(function(){return e[t]})}("undefined"!=typeof self?self:this,"Plot");